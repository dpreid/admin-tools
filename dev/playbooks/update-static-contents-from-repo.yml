---
- name: update static contents from git handler
  hosts: development
  become: yes
  gather_facts: no
  vars_files:
    - ../autogenerated/vars.yml
    
  tasks:

   - name: Git checkout static repo
     ansible.builtin.git:
       repo: "{{ static_repo_url }}"
       dest: "/var/www/git/{{ static_repo_name }}"
       
   # symbolic links might need updating - if so, run configure script again to set the items    
   - name: Create a symbolic links for dev-static sub-directories
     ansible.builtin.file:
       src:  "/var/www/git/{{ dev_static_repo_name }}/{{ item }}"
       dest: "/var/www/{{ domain }}/dev-static/{{ item }}"
       state: link
     loop: "{{ dev_static_sub_dirs }}"
     
   - name: Git checkout dev-static repo
     ansible.builtin.git:
       repo: "{{ dev_static_repo_url }}"
       dest: "/var/www/git/{{ dev_static_repo_name }}"
       
   # symbolic links might need updating - if so, run configure script again to set the items       
   - name: Create a symbolic links for dev-static sub-directories
     ansible.builtin.file:
       src:  "/var/www/git/{{ dev_static_repo_name }}/{{ item }}"
       dest: "/var/www/{{ domain }}/dev-static/{{ item }}"
       state: link
     loop: "{{ dev_static_sub_dirs }}"
    
     

  

